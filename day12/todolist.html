<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Todo List</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <style>
        .done {
            text-decoration: line-through;
        }

        button {
            border: none;
            background: none;
            cursor: pointer;
        }

        ul {
            list-style-type: none;
            padding-left: 0;
        }
    </style>
</head>

<body>
    <h1>Todo List</h1>
    <input type="text" id="title" value="">
    <button id="saveBtn">‚ûï</button>
    <hr />
    <ul id="listArea"></ul>

    <script>
        var cnt = 1;

        function loadTodoList() {
            const savedTodos = localStorage.getItem('todoList');
            if (savedTodos) {
                const todos = JSON.parse(savedTodos);
                todos.forEach(todo => {
                    addTodoElement(todo.no, todo.title, todo.done);
                });
                cnt = todos.length + 1;
            }
        }

        function saveTodoList() {
            const todos = [];
            $('#listArea li').each(function () {
                const no = $(this).data('no');
                const title = $(this).find('span').text();
                const done = $(this).find('.checkBox').prop('checked');
                todos.push({ no, title, done });
            });
            localStorage.setItem('todoList', JSON.stringify(todos));
        }

        function addTodoElement(no, title, done) {
            const doneClass = done ? 'done' : '';
            const checked = done ? 'checked' : '';
            $('#listArea').append(`<li data-no="${no}">
                <input type="checkbox" class="checkBox" ${checked}/>
                <span class="${doneClass}">${title}</span>
                <button class="editBtn">‚úé</button>
                <button class="delBtn">üóëÔ∏è</button>
            </li>`);
        }

        $(function () {
            loadTodoList();

            $('#saveBtn').on('click', function () {
                if ($('#title').val()) {
                    addTodoElement(`10${cnt++}`, $('#title').val(), false);
                    $('#title').val("");
                    saveTodoList();
                } else {
                    alert("ÎÇ¥Ïö©ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî");
                    $('#title').focus();
                    return;
                }
            });

            $('#listArea').on('click', 'button.delBtn', function () {
                $(this).parent().remove();
                saveTodoList();
            });

            $('#listArea').on('click', 'button.editBtn', function () {
                const $li = $(this).parent();
                const currentText = $li.find('span').text();
                $li.find('span').replaceWith(`<input type="text" class="editInput" value="${currentText}"/>`);
                $(this).text('‚úîÔ∏è').removeClass('editBtn').addClass('saveBtn');
            });

            $('#listArea').on('click', 'button.saveBtn', function () {
                const $li = $(this).parent();
                const newText = $li.find('.editInput').val();
                $li.find('.editInput').replaceWith(`<span>${newText}</span>`);
                $(this).text('‚úé').removeClass('saveBtn').addClass('editBtn');
                saveTodoList();
            });

            $('#listArea').on('change', '.checkBox', function () {
                const $li = $(this).parent();
                if (this.checked) {
                    $li.find('span').addClass('done');
                } else {
                    $li.find('span').removeClass('done');
                }
                saveTodoList();
            });
        });
    </script>
</body>

</html>
